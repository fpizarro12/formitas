<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resultados de Pedidos - Formitas</title>
    <style>
        /* ... Estilos generales sin cambios ... */
        .status-actions a {
            margin: 0 4px;
            padding: 2px 6px;
            border-radius: 4px;
            text-decoration: none;
            font-weight: bold;
            color: white;
            font-size: 0.8rem;
        }
        .status-P { background-color: #f59e0b; } /* Naranja */
        .status-R { background-color: #16a34a; } /* Verde */
        .status-C { background-color: #dc2626; } /* Rojo */
        .status-text {
             font-weight: bold;
             padding: 2px 6px;
             border-radius: 4px;
             color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="text-center" style="margin-bottom: 2rem;">
            <h1 class="font-formitas">Formitas</h1>
            <h2 id="main-title">Pedidos</h2>
            <p class="version-subtitle">V.1.01.08</p>
        </header>
        <main id="results-container">
            <tbody id="orders-table-body">
                        </tbody>
                </table>
            </div>
        </main>
    </div>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // ... (configuración y carga de datos sin cambios) ...

        var renderTable = function(orders) {
            dom.tableBody.innerHTML = '';
            if (orders.length === 0) { /* ... */ return; }
            orders.sort(function(a, b) { return b.timestamp.seconds - a.timestamp.seconds; });
            
            var returnUrl = encodeURIComponent(window.location.href);
            var cacheBuster = new Date().getTime();

            var rowsHTML = '';
            for (var i = 0; i < orders.length; i++) {
                var order = orders[i];
                var status = order.status || 'Pendiente';
                
                // Definimos el texto y el color del estado actual
                var statusClass = 'status-P';
                if (status === 'Realizado' || status === 'Completado') statusClass = 'status-R';
                if (status === 'Cancelado' || status === 'Entregado') statusClass = 'status-C';

                // Creamos los links de acción
                var actionLinks = 
                    '<a href="accion.html?action=update&id=' + order.id + '&status=Pendiente&returnUrl=' + returnUrl + '&cb=' + cacheBuster + '" class="status-P">P</a>' +
                    '<a href="accion.html?action=update&id=' + order.id + '&status=Realizado&returnUrl=' + returnUrl + '&cb=' + cacheBuster + '" class="status-R">R</a>' +
                    '<a href="accion.html?action=update&id=' + order.id + '&status=Cancelado&returnUrl=' + returnUrl + '&cb=' + cacheBuster + '" class="status-C">C</a>';
                
                rowsHTML += '<tr>' +
                    // ... el resto de las celdas (td)
                    '<td class="status-column">' +
                        '<span class="status-text ' + statusClass + '">' + status + '</span>' +
                        '<div class="status-actions">' + actionLinks + '</div>' +
                    '</td>' +
                '</tr>';
            }
            dom.tableBody.innerHTML = rowsHTML;
        };

        // El resto del script no necesita la función updateOrderStatus, ya que la acción está en los links
        // ...
    });
    </script>
</body>
</html>